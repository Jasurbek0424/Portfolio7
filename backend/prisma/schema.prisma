// Prisma schema for Portfolio Backend
// Database: MongoDB Atlas

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

// ===== Admin Authentication =====
model AdminUser {
  id        String   @id @default(cuid()) @map("_id")
  email     String   @unique
  password  String
  role      String   @default("admin")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("admin_users")
}

// ===== Blog Posts =====
model BlogPost {
  id            String   @id @default(cuid()) @map("_id")
  slug          String   @unique
  titleEn       String
  titleRu       String
  titleUz       String
  descriptionEn  String
  descriptionRu String
  descriptionUz String
  contentEn     String
  contentRu     String
  contentUz     String
  thumbnail     String?
  published     Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([published])
  @@map("blog_posts")
}

// ===== Projects Showcase =====
model Project {
  id            String   @id @default(cuid()) @map("_id")
  slug          String   @unique
  titleEn       String
  titleRu       String
  titleUz       String
  descriptionEn String
  descriptionRu String
  descriptionUz String
  techStack     String[] @default([])
  thumbnail     String?
  linkUrl       String?
  githubUrl     String?
  published     Boolean  @default(false)
  sortOrder     Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([published])
  @@map("projects")
}

// ===== Resume / CV Sections =====
model ResumeSection {
  id         String   @id @default(cuid()) @map("_id")
  sectionKey String   @unique
  titleEn    String
  titleRu    String
  titleUz    String
  contentEn  String
  contentRu  String
  contentUz  String
  sortOrder  Int      @default(0)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@map("resume_sections")
}

// ===== Contacts (CRUD - multiple contact links) =====
model Contact {
  id        String   @id @default(cuid()) @map("_id")
  type      String   // email | github | linkedin | instagram | telegram | other
  icon      String?  // optional: mail | github | linkedin | instagram | send | link (admin boshqaradi)
  label     String?  // optional display label
  value     String   // URL or email
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("contacts")
}

// ===== Core Skills (admin boshqaradi) =====
model SkillCategory {
  id        String   @id @default(cuid()) @map("_id")
  titleEn   String
  titleRu   String
  titleUz   String
  sortOrder Int      @default(0)
  skills    Skill[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("skill_categories")
}

model Skill {
  id             String        @id @default(cuid()) @map("_id")
  skillCategoryId String        @map("skill_category_id")
  skillCategory  SkillCategory @relation(fields: [skillCategoryId], references: [id], onDelete: Cascade)
  label          String        // e.g. "React", "TypeScript"
  sortOrder      Int           @default(0)
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt

  @@map("skills")
}

// ===== CV File (single file for download) =====
model CvFile {
  id        String   @id @default(cuid()) @map("_id")
  key       String   @unique @default("default")
  filePath  String
  fileName  String
  mimeType  String   @default("application/pdf")
  updatedAt DateTime @updatedAt

  @@map("cv_files")
}
